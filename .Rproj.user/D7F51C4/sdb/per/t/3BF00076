{
    "collab_server" : "",
    "contents" : "library(gdata)\nlibrary(dplyr)\nlibrary(magrittr)\nlibrary(stringr)\n\n# import LPI raw data\n# excluded 2007 because of different variables tracked\nurl <- \"http://lpi.worldbank.org/sites/default/files/International_LPI_from_2007_to_2016.xlsx\"\nlpi_raw_2010 <- read.xls(url, sheet = 3) %>% mutate(Year = 2010)\nlpi_raw_2012 <- read.xls(url, sheet = 2) %>% mutate(Year = 2012)\nlpi_raw_2014 <- read.xls(url, sheet = 1) %>% mutate(Year = 2014)\nlpi_raw_2016 <- read.xls(url, sheet = 5) %>% mutate(Year = 2016)\n\nrm(url)\n\n# tidy and combine\nraw_files <- ls()\nlpi <- data.frame(NULL)\n\nfor(i in raw_files){\n        \n        j <- get(i)\n        names(j)[2] <- \"Code\"\n        \n        j <- j %>%\n                .[-1, ] %>%\n                select(-contains(\"x.\")) %>%\n                set_colnames(c(\"Country\", \"Code\", \"Overall LPI Score\", \"Overall LPI Rank\",\n                               \"Customs\", \"Infrastructure\", \"International Shipments\", \n                               \"Logistics Quality & Competence\", \"Tracking & Tracing\",\n                               \"Timeliness\", \"Year\"))\n        \n        lpi <- rbind(lpi, j)\n}\n\nrm(raw_files, i, j, lpi_raw_2010, lpi_raw_2012, lpi_raw_2014, lpi_raw_2016)\n\n\n# clean up non-UTF-8 characters\nlpi$Country <- as.character(lpi$Country)\n\n#str_detect(lpi$Country, \"voire\") %>% which(.)\nlpi$Country[c(109, 238, 389, 565)] <- \"Cote d Ivoire\"\n\n#str_detect(lpi$Country, \"Tom\") %>% which(.)\nlpi$Country[c(269, 394, 603)] <- \"Sco Tomi and Principe\"\n\nwrite.csv(lpi, \"data/lpi.csv\", row.names = FALSE)\nsaveRDS(lpi, file = \"data/lpi.rds\")\n",
    "created" : 1469560272624.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "107715283",
    "id" : "3BF00076",
    "lastKnownWriteTime" : 1469561818,
    "last_content_update" : 1469561818220,
    "path" : "~/Desktop/Personal/Academia/LPI Rankings/data-cleaning.R",
    "project_path" : "data-cleaning.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}